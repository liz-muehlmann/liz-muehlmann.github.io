I"ØÂ<p>This is part three of my <a href="http://localhost:4000/pages/tag-forest/#cartography" target="_blank" rel="noopener noreferrer">cartography in R</a> series. If you are just finding this, I suggest taking a look at <a href="http://localhost:4000/notes/cartography-part-one" target="_blank" rel="noopener noreferrer">part I</a> and <a href="http://localhost:4000/notes/cartography-part-two" target="_blank" rel="noopener noreferrer">part II</a> first.</p>

<p>In this post, I will download and process the National Park data. Once that‚Äôs done, I‚Äôll add it to the base map I created in <a href="http://localhost:4000/notes/cartography-part-two" target="_blank" rel="noopener noreferrer">part II</a>.</p>

<!--more-->

<div class="boxed">
<i class="fa-regular fa-note-sticky fa-xl"></i> <i>Note:</i> I know that my posts are verbose. I am sorry that I am not more concise but one of the biggest problems I have with code documentation is that it assumes you already know what you're doing. I'm writing these for absolute beginners that want to know what each part of the code does. If you want more concise explanations, I suggest looking at the annotated <a href="https://github.com/liz-muehlmann/nps" target="_blank" rel="noopener no referrer">r files</a> in the project's GitHub.
</div>

<h3 id="project-outline">project outline</h3>
<hr />

<p>I had to break the tutorial into different parts because it became unwieldy. I list the component parts below. The annotated version of the code can be found in this project‚Äôs repository in the folder called <a href="https://github.com/liz-muehlmann/nps" target="_blank" rel="noopener noreferrer">r files</a></p>

<p><a href="http://localhost:4000/notes/cartography-part-one" target="_blank" rel="noopener noreferrer">I. cartography in r part one</a></p>
<ul>
  <li>install packages</li>
  <li>download usa shapefile</li>
  <li>shift alaska and hawaii</li>
  <li>save shapefile</li>
</ul>

<p><a href="http://localhost:4000/notes/cartography-part-two" target="_blank" rel="noopener noreferrer">II. cartography in r part two</a></p>
<ul>
  <li>create usa base map</li>
</ul>

<p><a href="http://localhost:4000/notes/cartography-part-three" target="_blank" rel="noopener noreferrer">III. cartography in r part three</a></p>
<ul>
  <li>download national park data</li>
  <li>process national park data</li>
  <li>shift alaska and hawaii national parks</li>
  <li>save shapefile</li>
  <li>add national parks to map</li>
</ul>

<p><a href="http://localhost:4000/notes/cartography-part-four" target="_blank" rel="noopener noreferrer">IV. cartography in r part four </a></p>
<ul>
  <li>download state park data</li>
  <li>process state park data</li>
  <li>shift alaska and hawaii state parks</li>
  <li>separate state park data</li>
  <li>save state park data</li>
</ul>

<p><a href="http://localhost:4000/notes/cartography-part-five" target="_blank" rel="noopener noreferrer">V. cartography in r part five</a></p>
<ul>
  <li>add in shiny functionality</li>
  <li>add markers to visited parks</li>
  <li>save and embed map</li>
</ul>

<p><a href="http://localhost:4000/notes/cartography-part-six" target="_blank" rel="noopener noreferrer">VI. cartography in r part six</a></p>
<ul>
  <li>create individual state maps</li>
  <li>add in shiny functionality</li>
  <li>add markers to visited parks</li>
  <li>save and embed maps</li>
</ul>

<h3 id="1-load-libraries">1. load libraries</h3>
<hr />

<figure class="highlight"><pre><code class="language-r" data-lang="r"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="code"><pre><span class="w">    </span><span class="c1">## load libraries</span><span class="w">
    </span><span class="n">library</span><span class="p">(</span><span class="s2">"tidyverse"</span><span class="p">)</span><span class="w">        </span><span class="c1"># data manipulation &amp; map creation</span><span class="w">
    </span><span class="n">library</span><span class="p">(</span><span class="s2">"sf"</span><span class="p">)</span><span class="w">               </span><span class="c1"># loads shapefile</span><span class="w">
    </span><span class="n">library</span><span class="p">(</span><span class="s2">"leaflet"</span><span class="p">)</span><span class="w">          </span><span class="c1"># creates the map</span><span class="w">
    </span><span class="n">library</span><span class="p">(</span><span class="s2">"operator.tools"</span><span class="p">)</span><span class="w">   </span><span class="c1"># not-in function</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>I am not going to explain in detail what each of these packages do because I already covered it in <a href="http://localhost:4000/notes/cartography-part-one" target="_blank" rel="noopener noreferrer">part one</a>.</p>

<h3 id="2-load-usa-data">2. load usa data</h3>
<hr />

<figure class="highlight"><pre><code class="language-r" data-lang="r"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
</pre></td><td class="code"><pre><span class="w">    </span><span class="c1">## load data</span><span class="w">
    </span><span class="n">states</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_sf</span><span class="p">(</span><span class="s2">"~/Documents/Github/nps/shapefiles/shifted/usa/usa.shp"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Be sure to change <code>~/Documents/Github/nps/shapefiles/shifted/usa/usa.shp</code> to reflect wherever you saved the shifted shapefile.</p>

<p>If your data processing and base map creation are in the same file, you can skip this line, and when you make the Leaflet call below, you‚Äôll use the name of the variable where the shape data is stored.</p>

<h3 id="3-download-national-park-data">3. download national park data</h3>
<hr />

<p>The National Park Service provides all the data we‚Äôll need to make the map. The data is accessible on the <a href="https://public-nps.opendata.arcgis.com/" target="_blank" rel="noopener noreferrer">ArcGIS‚Äô Open Data</a> website. Once you click on the link you‚Äôll see a bunch of icons that lead to different data that‚Äôs available for download. Click on the one for <em>boundaries</em>.</p>

<figure>
    
    <a href="/assets/notes-images/nps/nps-17.jpg" target="_blank" rel="noopener noreferrer">
        <img src="/assets/notes-images/nps/nps-17.jpg" alt="Image: NPS GIS website" class="img-fluid mx-auto d-block" />
    </a>
    
    <figcaption><span>NPS GIS website</span></figcaption>
</figure>

<p>From here, you‚Äôll be taken to a list of available National Park data. The second link should be <em>nps boundary</em> which contains the shape data for all the National Parks in the United States. The file contains all the data for the park outlines along with hiking trails, rest areas, and lots of other data.</p>

<figure>
    
    <a href="/assets/notes-images/nps/nps-18.jpg" target="_blank" rel="noopener noreferrer">
        <img src="/assets/notes-images/nps/nps-18.jpg" alt="Image: NPS download page" class="img-fluid mx-auto d-block" />
    </a>
    
    <figcaption><span>NPS download page</span></figcaption>
</figure>

<p>The <em>nps boundary</em> link will take you to a map showing the national parks. On the left, there will be a <em>download</em> link on the left.</p>

<figure>
    
    <a href="/assets/notes-images/nps/nps-19.jpg" target="_blank" rel="noopener noreferrer">
        <img src="/assets/notes-images/nps/nps-19.jpg" alt="Image: NPS map and download link" class="img-fluid mx-auto d-block" />
    </a>
    
    <figcaption><span>NPS map and download link</span></figcaption>
</figure>

<p>From here, you‚Äôll have a few download options. The National Park Service provides the data in different formats including CSV and Shapefile. You‚Äôll want to download the shapefile version.</p>

<figure>
    
    <a href="/assets/notes-images/nps/nps-20.jpg" target="_blank" rel="noopener noreferrer">
        <img src="/assets/notes-images/nps/nps-20.jpg" alt="Image: download nps shapefile" class="img-fluid mx-auto d-block" />
    </a>
    
    <figcaption><span>download nps shapefile</span></figcaption>
</figure>

<p>Be sure to save the file somewhere on your hard drive that is easy to find. When it finishes downloading, be sure to unzip the file. There will be four files inside the folder. All of them need to be kept in the same location. Even though we‚Äôll only load the <code>.shp</code> file, R uses the three others to create the necessary shapes.</p>

<h3 id="4-process-national-park-data">4. process national park data</h3>
<hr />

<p>The code below may look intimidating, but it‚Äôs fairly straight forward. I‚Äôll go over each line below.</p>

<div class="boxed">
<i class="fa-regular fa-note-sticky fa-xl"></i> <i>Note:</i> I will give the entire codeblock first. I also include the individual line before describing what it does. I find this to be cleaner than including a bunch of comments in the code itself. If you want to copy and paste the code to your own file, you only need to copy the code block and not each individual line.</div>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre></td><td class="code"><pre><span class="w">    </span><span class="c1">## create territories list</span><span class="w">
    </span><span class="n">territories</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"AS"</span><span class="p">,</span><span class="w"> </span><span class="s2">"GU"</span><span class="p">,</span><span class="w"> </span><span class="s2">"MP"</span><span class="p">,</span><span class="w"> </span><span class="s2">"PR"</span><span class="p">,</span><span class="w"> </span><span class="s2">"VI"</span><span class="p">)</span><span class="w">

    </span><span class="c1">## load and process nps data</span><span class="w">
    </span><span class="n">nps</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_sf</span><span class="p">(</span><span class="s2">"./shapefiles/original/nps/NPS_-_Land_Resources_Division_Boundary_and_Tract_Data_Service.shp"</span><span class="p">)</span><span class="w">  </span><span class="o">%&gt;%</span><span class="w"> 
    </span><span class="n">select</span><span class="p">(</span><span class="n">STATE</span><span class="p">,</span><span class="w"> </span><span class="n">UNIT_TYPE</span><span class="p">,</span><span class="w"> </span><span class="n">PARKNAME</span><span class="p">,</span><span class="w"> </span><span class="n">Shape__Are</span><span class="p">,</span><span class="w"> </span><span class="n">geometry</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
    </span><span class="n">filter</span><span class="p">(</span><span class="n">STATE</span><span class="w"> </span><span class="o">%!in%</span><span class="w"> </span><span class="n">territories</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">  
    </span><span class="n">mutate</span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">case_when</span><span class="p">(</span><span class="n">UNIT_TYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"International Historic Site"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"International Historic Site"</span><span class="p">,</span><span class="w"> </span><span class="c1"># there's 23 types of national park, I wanted to reduce this number.</span><span class="w">
                </span><span class="n">UNIT_TYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"National Battlefield Site"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"National Military or Battlefield"</span><span class="p">,</span><span class="w"> </span><span class="c1"># lines 56-77 reduce the number of park types</span><span class="w">
                </span><span class="n">UNIT_TYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"National Military Park"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"National Military or Battlefield"</span><span class="p">,</span><span class="w"> 
                </span><span class="n">UNIT_TYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"National Battlefield"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"National Military or Battlefield"</span><span class="p">,</span><span class="w">
                </span><span class="n">UNIT_TYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"National Historical Park"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"National Historical Park, Site, Monument, or Memorial"</span><span class="p">,</span><span class="w">
                </span><span class="n">UNIT_TYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"National Historic Site"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"National Historical Park, Site, Monument, or Memorial"</span><span class="p">,</span><span class="w">
                </span><span class="n">UNIT_TYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"National Historic Trail"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"National Historical Park, Site, Monument, or Memorial"</span><span class="p">,</span><span class="w">
                </span><span class="n">UNIT_TYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"National Memorial"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"National Historical Park, Site, Monument, or Memorial"</span><span class="p">,</span><span class="w">
                </span><span class="n">UNIT_TYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"National Monument"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"National Historical Park, Site, Monument, or Memorial"</span><span class="p">,</span><span class="w">
                </span><span class="n">UNIT_TYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"National Preserve"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"National Preserve, Reserve, or Recreation Area"</span><span class="p">,</span><span class="w">
                </span><span class="n">UNIT_TYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"National Reserve"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"National Preserve, Reserve, or Recreation Area"</span><span class="p">,</span><span class="w">
                </span><span class="n">UNIT_TYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"National Recreation Area"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"National Preserve, Reserve, or Recreation Area"</span><span class="p">,</span><span class="w">
                </span><span class="n">UNIT_TYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"National River"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"National River, Lakeshore, or Seashore"</span><span class="p">,</span><span class="w">
                </span><span class="n">UNIT_TYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"National Lakeshore"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"National River, Lakeshore, or Seashore"</span><span class="p">,</span><span class="w">
                </span><span class="n">UNIT_TYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"National Wild &amp; Scenic River"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"National River, Lakeshore, or Seashore"</span><span class="p">,</span><span class="w">
                </span><span class="n">UNIT_TYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"National Seashore"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"National River, Lakeshore, or Seashore"</span><span class="p">,</span><span class="w">
                </span><span class="n">UNIT_TYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"National Trails Syste"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"National Trail"</span><span class="p">,</span><span class="w">
                </span><span class="n">UNIT_TYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"National Scenic Trail"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"National Trail"</span><span class="p">,</span><span class="w">
                </span><span class="n">UNIT_TYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"National Park"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"National Park or Parkway"</span><span class="p">,</span><span class="w">
                </span><span class="n">UNIT_TYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Park"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"National Park or Parkway"</span><span class="p">,</span><span class="w">
                </span><span class="n">UNIT_TYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Parkway"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"National Park or Parkway"</span><span class="p">,</span><span class="w">
                </span><span class="n">UNIT_TYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Other Designation"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"Other National Land Area"</span><span class="p">))</span><span class="w">  </span><span class="o">%&gt;%</span><span class="w">  
    </span><span class="n">mutate</span><span class="p">(</span><span class="n">visited</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">case_when</span><span class="p">(</span><span class="n">PARKNAME</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Joshua Tree"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"visited"</span><span class="p">,</span><span class="w"> 
                                </span><span class="n">PARKNAME</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Redwood"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"visited"</span><span class="p">,</span><span class="w"> 
                                </span><span class="n">PARKNAME</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Santa Monica Mountains"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"visited"</span><span class="p">,</span><span class="w"> 
                                </span><span class="n">PARKNAME</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Sequoia"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"visited"</span><span class="p">,</span><span class="w"> 
                                </span><span class="n">PARKNAME</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Kings Canyon"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"visited"</span><span class="p">,</span><span class="w">
                                </span><span class="n">PARKNAME</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Lewis and Clark"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"visited"</span><span class="p">,</span><span class="w">
                                </span><span class="n">PARKNAME</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Mount Rainier"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"visited"</span><span class="p">,</span><span class="w">
                                </span><span class="kc">TRUE</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"not visited"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">  
    </span><span class="n">shift_geometry</span><span class="p">(</span><span class="n">preserve_area</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> 
                    </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"below"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
    </span><span class="n">sf</span><span class="o">::</span><span class="n">st_transform</span><span class="p">(</span><span class="s2">"+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"</span><span class="p">)</span><span class="w">

    </span><span class="c1">## save the shifted national park data</span><span class="w">
    </span><span class="n">st_write</span><span class="p">(</span><span class="n">nps</span><span class="p">,</span><span class="w"> </span><span class="s2">"~/Documents/GitHub/nps/shapefiles/shifted/nps/nps.shp"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></figure>

<ul>
  <li>line 2</li>
</ul>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="m">2</span><span class="w">    </span><span class="n">territories</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"AS"</span><span class="p">,</span><span class="w"> </span><span class="s2">"GU"</span><span class="p">,</span><span class="w"> </span><span class="s2">"MP"</span><span class="p">,</span><span class="w"> </span><span class="s2">"PR"</span><span class="p">,</span><span class="w"> </span><span class="s2">"VI"</span><span class="p">)</span></code></pre></figure>

<p>In <a href="http://localhost:4000/notes/cartography-part-one" target="_blank" rel="noopener noreferrer">part I</a> of this series I talked about how R has an <code>%in%</code> function, but not a <code>%!in%</code> function. Here‚Äôs where the latter function shines.</p>

<p>The United States is still an empire with its associated territories and islands. In this project I am interested in the 50 states - without these other areas. As a result, I need to filter them out. Using base R‚Äôs <code>%in%</code> function I would have to create a variable that contains the postal abbreviations for all 50 states. That is annoying. Instead, I want to use the shorter list that only includes the US‚Äô associated islands and territories. To do so, however, I need to use the operator tools‚Äô <code>%!in%</code> function.</p>

<p>Line 2 creates the list of US territories that I filter out in line 7. The <code>c()</code> function in R means combine or concatenate. Inside the parenthesis are the five postal codes for the American Samoa, Guam, the Northern Mariana Islands, Puerto Rico, and the Virgin Islands.</p>

<center><i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i></center>

<ul>
  <li>line 5</li>
</ul>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="m">5</span><span class="w">   </span><span class="n">nps</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_sf</span><span class="p">(</span><span class="s2">"path/to/file/NPS_-_Land_Resources_Division_Boundary_and_Tract_Data_Service.shp"</span><span class="p">)</span><span class="w">  </span><span class="o">%&gt;%</span><span class="w"> </span></code></pre></figure>

<p><code>nps &lt;- read_sf("path/to/file.shp")</code> loads the National Park data set to a variable called <code>nps</code> using the <code>read_sf()</code> function that is part of the <em>sf</em> package. You will need to change the file path so it reflects where you saved the data on your hard drive.</p>

<p>The <code> %&gt;% </code> operator is part of the tidyverse package. It tells R to go to the next line and process the next command. It has to go at the end of a line, rather than the beginning.</p>

<center><i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i></center>

<ul>
  <li>line 6</li>
</ul>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="m">6</span><span class="w">    </span><span class="n">select</span><span class="p">(</span><span class="n">STATE</span><span class="p">,</span><span class="w"> </span><span class="n">UNIT_TYPE</span><span class="p">,</span><span class="w"> </span><span class="n">PARKNAME</span><span class="p">,</span><span class="w"> </span><span class="n">Shape__Are</span><span class="p">,</span><span class="w"> </span><span class="n">geometry</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span></code></pre></figure>

<p><code>select</code> is part of the tidyverse package. With it, we can select columns by their name rather than their associated number. Large data sets take more computing power because the computer has to iterate over more rows. Unfortunately, rendering maps also takes a lot of computing power so I like to discard any unnecessary columns to reduce the amount of effort my computer has to exert.</p>

<p>Deciding on which columns to keep will depend on the data you‚Äôre using and what you want to map (or analyze). I know for my project I want to include a few things:</p>
<ul>
  <li>the state where the park is located</li>
  <li>the park name</li>
  <li>the park type (park, battlefield, memorial, etc)</li>
  <li>and the park‚Äôs size.</li>
</ul>

<p>There‚Äôs a couple ways to inspect the data to see what kind of information is available.</p>

<ol>
  <li>You can view the entire data set by using <code>view(nps)</code> but as the number of data points increases, so does R‚Äôs struggle with opening it. I‚Äôve found that <a href="https://code.visualstudio.com/" target="_blank" rel="noopener noreferrer">VSCode</a> doesn‚Äôt throw as big of a fit as R Studio when opening large data sets.</li>
  <li>Another way is to just look at the column names using <code>data.frame(colnames(nps))</code>. This will return a list of the data set‚Äôs column names. This is my preferred method. I then go to the documentation to see what each column contains. This isn‚Äôt fool-proof because it really depends on if the data has good documentation.</li>
</ol>

<p>The National Park data includes a lot of information about who created the data and maintains the property. I‚Äôm not interested in this, so in line 6 I select the following columns:</p>
<ul>
  <li>STATE [the two character state abbreviation]</li>
  <li>UNIT_TYPE [if it‚Äôs a national park, battlefield, etc]</li>
  <li>PARKNAME [the name of the park]</li>
  <li>Shape__Are [the size of the park]</li>
  <li>geometry</li>
</ul>

<div class="boxed"><i class="fa-regular fa-note-sticky fa-xl"></i> <i>Note:</i> The column name must be <i>exact</i> for select() to work. For example, in the NPS data, the park area is stored the <i>Shape__Are</i> column - two underscores and no a in area - and I have to use that exact format when selecting the column.</div>

<p>The <em>geometry</em> column is specific to shapefiles and it includes the coordinates of the shape. It will be kept automatically - unless you use the <code>st_drop_geometry()</code> function. I like to specifically select so I remember it‚Äôs there.</p>

<center><i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i></center>

<ul>
  <li>line 7</li>
</ul>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="m">7</span><span class="w">    </span><span class="n">filter</span><span class="p">(</span><span class="n">STATE</span><span class="w"> </span><span class="o">%!in%</span><span class="w"> </span><span class="n">territories</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">  </span></code></pre></figure>

<p>In line 7 I use the territories list I created in line 2 to filter out the United States‚Äô associated areas. Since the nps data uses the two character state abbreviation, I have to use the two character abbreviation for the territories. Searching for ‚ÄúGuam,‚Äù for example, won‚Äôt work.</p>

<p><code>filter()</code> is part of the tidyverse and it uses conditional language. In the parentheses is a condition that must be true if the tidyverse is going to keep the row. Starting at the top of the data, R goes ‚Äúalright, does the value in the STATE column match any of the values in the territories list?‚Äù If the condition is TRUE, R adds the row to the new data frame.</p>

<div class="boxed"><i class="fa-regular fa-note-sticky fa-xl"></i> <i>Note:</i> Since we're using the <code>%!in%</code> operator, any row that evaluates as TRUE will be kept because the value is NOT found in the territories list. If I wanted to keep <i>only</i> the territories, I would use the <code>%in%</code> operator and only the rows with STATE abbreviations found in the territories list would be kept. </div>

<p>For example, if the STATE value in row 1 is CA, filter looks at it and goes ‚Äúis CA NOT IN territories?‚Äù If that is TRUE, keep it because we want only the values that are NOT IN the territories list.</p>

<center><i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i></center>

<ul>
  <li>lines 8-29</li>
</ul>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="m">8</span><span class="w">    </span><span class="n">mutate</span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">case_when</span><span class="p">(</span><span class="n">UNIT_TYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"International Historic Site"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"International Historic Site"</span><span class="p">,</span></code></pre></figure>

<p><code>mutate()</code> is part of the tidyverse package and it‚Äôs extremely versatile. It is mainly used to create new variables or modify existing ones.</p>

<p>The NPS data set has 23 different types of National Parks listed (you can view all of them by running <code>levels(as.factor(nps$UNIT_TYPE))</code>). I know that in later posts, I‚Äôm going to color code the land by type (blue for rivers, green for national parks, etc) so I wanted to reduce the number of colors I would have to use.</p>

<p><code>mutate()</code>‚Äôs first argument, <code>type = </code> creates a new column called <code>type</code>. R will populate the newly created column with whatever comes after the first (singular) equal <code>=</code> sign. For example, I can put <code>type = NA</code> and every row in the column will say <code>NA</code>.</p>

<p>Here, I am using the <code>case_when()</code> function, which is also part of the tidyverse. The logic of <code>case_when</code> is fairly straight forward. The first value is the name of the column you want R to look in (here: <code>UNIT_TYPE</code>). Next, is a conditional. Here I am looking for an exact match (<code>==</code>) to the string (words) inside the first set of quotation marks (in line 8: <code>"International Historic Site"</code>). The last part of the argument is what I want R to put in the <code>type</code> column when it finds a row where the <code>UNIT_TYPE</code> is <code>"International Historic Site"</code>.</p>

<p>In its general form, the format is <code>case_when(COLUMN_NAME == "original_value" ~ "new_value")</code></p>

<p>Lines 9-29 do the same thing for the other park types. You can reduce the parks however you want or use all 23 types. Just remember that the value before the tilde <code>~</code> has to match the values found in the data exactly. For example, in line 24 I change the NPS data‚Äôs <em>National Trail Syste</em> value to be <em>National Trail</em>. Whomever created the data set did not spell <em>system</em> correctly, so for R to match the value I also have to omit the last letter in system.</p>

<center><i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i></center>

<ul>
  <li>lines 30-37</li>
</ul>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="m">30</span><span class="w">    </span><span class="n">mutate</span><span class="p">(</span><span class="n">visited</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">case_when</span><span class="p">(</span><span class="n">PARKNAME</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Joshua Tree"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"visited"</span><span class="p">,</span></code></pre></figure>

<p>Lines 30-37 use the same <code>mutate()</code> and <code>case_when</code> logic as above. Instead of reducing the number of park types, I use it to mark the different parks I have visited.</p>

<p>Line 30 creates the new column, <code>visited</code> and uses <code>case_when</code> to look for the names of the parks that I‚Äôve been to. If I have visited them, it adds <code>visited</code> to the column of the same name.</p>

<p>The last line, <code>TRUE ~ "not_visited))</code>, acts as an else statement. For any park not listed above, it will put <code>not visited</code> in the <code>visited</code> column I created.</p>

<p>This feels like a very brute-force method of tracking which parks I‚Äôve visited, but I haven‚Äôt spend much time trying to find another way.</p>

<center><i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i></center>

<ul>
  <li>line 38-39</li>
</ul>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="m">38</span><span class="w">    </span><span class="n">shift_geometry</span><span class="p">(</span><span class="n">preserve_area</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> 
</span><span class="m">39</span><span class="w">                   </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"below"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span></code></pre></figure>

<p>In <a href="http://localhost:4000/notes/cartography-part-one" target="_blank" rel="noopener noreferrer">part I</a>, when I made the base map, I moved Alaska and Hawaii so they were of similar size and closer to the continental USA. For the map to display the parks correctly, I have to shift them as well.</p>

<p>I went over these two lines in part II, so I won‚Äôt go over them again here. If you want to read more about them, check out that post.</p>

<center><i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i></center>

<ul>
  <li>line 40</li>
</ul>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="m">40</span><span class="w">  </span><span class="n">sf</span><span class="o">::</span><span class="n">st_transform</span><span class="p">(</span><span class="s1">'+proj=longlat +datum=WGS84'</span><span class="p">)</span></code></pre></figure>

<p>The last line uses the <code>st_transform()</code> function from the <em>sf</em> package to covert the data set from NAD83 to WGS84. Leaflet requires WGS84, so be sure to include this line at the end of your data manipulation.</p>

<p>I covered the WGS84 ellipsoid in <a href="http://localhost:4000/notes/cartography-part-one" target="_blank" rel="noopener noreferrer">part I</a>, if you want to read more about it.</p>

<center><i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i></center>

<ul>
  <li>line 43</li>
</ul>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="m">43</span><span class="w">  </span><span class="n">st_write</span><span class="p">(</span><span class="n">nps</span><span class="p">,</span><span class="w"> </span><span class="s2">"~/Documents/GitHub/nps/shapefiles/shifted/nps/nps.shp"</span><span class="p">)</span></code></pre></figure>

<p>Strictly speaking, this line isn‚Äôt necessary. You can do all your data processing in the same file where you make your map, but I prefer to separate the steps into different files.</p>

<p>As a result, I save the shifted data to my hard drive so it‚Äôs easier to load later. I usually have this line commented out (by placing <code>#</code> at the start of the line) after I save it the first time. I don‚Äôt want it to save every time I run the rest of the code.</p>

<h3 id="5-add-national-parks-to-base-map">5. add national parks to base map</h3>
<hr />

<figure class="highlight"><pre><code class="language-r" data-lang="r"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre></td><td class="code"><pre><span class="c1">## create usa Base Map using leaflet()</span><span class="w">
    </span><span class="n">map</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">leaflet</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">addPolygons</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">states</span><span class="p">,</span><span class="w">
        </span><span class="n">smoothFactor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span><span class="p">,</span><span class="w">
        </span><span class="n">fillColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#808080"</span><span class="p">,</span><span class="w">
        </span><span class="n">fillOpacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w">
        </span><span class="n">stroke</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
        </span><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w">
        </span><span class="n">opacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w">
        </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#808080"</span><span class="p">,</span><span class="w">
        </span><span class="n">highlight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">highlightOptions</span><span class="p">(</span><span class="w">
            </span><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w">
            </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#000000"</span><span class="p">,</span><span class="w">
            </span><span class="n">fillOpacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.7</span><span class="p">,</span><span class="w">
            </span><span class="n">bringToFront</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">),</span><span class="w">
        </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Base Map"</span><span class="p">)</span><span class="w">  </span><span class="o">%&gt;%</span><span class="w"> 
    </span><span class="n">addPolygons</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nps</span><span class="p">,</span><span class="w">
        </span><span class="n">smoothFactor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span><span class="p">,</span><span class="w">                 
        </span><span class="n">fillColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#354f52"</span><span class="p">,</span><span class="w">
        </span><span class="n">fillOpacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w">
        </span><span class="n">stroke</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
        </span><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w">     
        </span><span class="n">opacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w">                       
        </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#354f52"</span><span class="p">,</span><span class="w">             
        </span><span class="n">highlight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">highlightOptions</span><span class="p">(</span><span class="w">
            </span><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w">
            </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#fff"</span><span class="p">,</span><span class="w">
            </span><span class="n">fillOpacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.8</span><span class="p">,</span><span class="w">
            </span><span class="n">bringToFront</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w">
        </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"National Parks"</span><span class="p">)</span><span class="w">  </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">addLayersControl</span><span class="p">(</span><span class="w">
        </span><span class="n">baseGroups</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Base Map"</span><span class="p">,</span><span class="w">
        </span><span class="n">overlayGroups</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"National Parks"</span><span class="p">,</span><span class="w">
        </span><span class="n">options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">layersControlOptions</span><span class="p">(</span><span class="n">collapsed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></pre></figure>

<ul>
  <li>lines 2-16</li>
</ul>

<p>Lines 2-16 are identical to those in <a href="http://localhost:4000/notes/cartography-part-two" target="_blank" rel="noopener noreferrer">part II</a> where I created the base map. I am not going to cover these sections in detail, because I covered it previously.</p>

<center><i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i></center>

<ul>
  <li>line 17</li>
</ul>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="m">17</span><span class="w">    </span><span class="n">addPolygons</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nps</span><span class="p">,</span></code></pre></figure>

<p>To add the National Park data to the base map, we call <code>addPolygons()</code> again. The arguments are the same as before - color, opacity, outline style - just with different values. By changing those values, we can differentiate the base map from the national park data.</p>

<p>Since we‚Äôre mapping the National Parks and not the states, we have to tell R where the data is located using <code>data = nps</code>.</p>

<center><i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i></center>

<ul>
  <li>line 18</li>
</ul>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="m">18</span><span class="w">   </span><span class="n">smoothFactor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span><span class="p">,</span></code></pre></figure>

<p><code>smoothFactor()</code> determines how detailed the park boundaries should be. The lower the number, the more detailed the shape. The higher the number, the smoother the parks will render. I usually match this to whatever I set for the base map for consistency.</p>

<center><i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i></center>

<ul>
  <li>lines 19-20</li>
</ul>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="m">19</span><span class="w">   </span><span class="n">fillColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#354f52"</span><span class="p">,</span><span class="w">
</span><span class="m">20</span><span class="w">   </span><span class="n">fillOpacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span></code></pre></figure>

<p>Define the color and transparency of the National Parks. In a future post, I am going to change the color of each type of public land, but for now, I‚Äôll make them all a nice sage green color <code>#354f52</code>. I also want to make the parks to be fully opaque.</p>

<center><i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i></center>

<ul>
  <li>lines 21-24</li>
</ul>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="m">21</span><span class="w">    </span><span class="n">stroke</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
</span><span class="m">22</span><span class="w">    </span><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w">     
</span><span class="m">23</span><span class="w">    </span><span class="n">opacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w">                       
</span><span class="m">24</span><span class="w">    </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#354f52"</span><span class="p">,</span></code></pre></figure>

<p>The next four lines (21-24) define what kind of outline the National Parks will have. I detail each of these arguments in <a href="http://localhost:4000/notes/cartography-part-two" target="_blank" rel="noopener noreferrer">part II</a> of this series.</p>

<p>Briefly, I want there to be an outline to each park (<code>stroke = TRUE</code>) that‚Äôs thicker <code>weight = 1</code> than the outline used on the base map. I do not like the way it looks at full opacity, so I make it half-transparent (<code>opacity = 0.5</code>). Finally, I want the outline <code>color = "#354f52</code> to be the same color as the fill. This will matter more when I change the fill color of the parks later on.</p>

<center><i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i></center>

<ul>
  <li>lines 25-28</li>
</ul>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="m">25</span><span class="w">  </span><span class="n">highlight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">highlightOptions</span><span class="p">(</span><span class="w">
</span><span class="m">26</span><span class="w">              </span><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w">
</span><span class="m">27</span><span class="w">              </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#fff"</span><span class="p">,</span><span class="w">
</span><span class="m">28</span><span class="w">              </span><span class="n">fillOpacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.8</span><span class="p">,</span></code></pre></figure>

<p>Lines 25-28 define the National Park‚Äôs behavior on mouseover. First we have to define and initialize the <code>highlightOptions()</code> function. The function take similar arguments as the <code>addPolygons</code> function - both of which I go over in detail in <a href="http://localhost:4000/notes/cartography-part-two" target="_blank" rel="noopener noreferrer">part II</a>.</p>

<p>I want to keep the mouseover behavior noticeable, but simple. To do so, I set the outline‚Äôs thickness to be <code>weight = 3</code>.  This will give the shape a nice border that differentiates it from the rest of the map.</p>

<p><code>color = "#fff</code> sets the outline‚Äôs color on mouseover only. So, when inactive, the outline color will match the fill color, but on mouseover the outline color switches to white (<code>#fff</code>).</p>

<div class="boxed">
<i class="fa-regular fa-note-sticky fa-xl"></i> <i>Note:</i> When the hex code repeats (like, white - #ffffff, black - #000000, or grey #808080) you only need to include the first three characters. </div>

<center><i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i></center>

<ul>
  <li>line 29</li>
</ul>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="m">29</span><span class="w">    </span><span class="n">bringToFront</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span></code></pre></figure>

<p><code>bringToFront</code> can either be <code>TRUE</code> or <code>FALSE</code>. If <code>TRUE</code>, Leaflet will bring the park to the forefront on mouseover. This is useful later when we add in the state parks because national and state parks tend to be close together.</p>

<p>When <code>FALSE</code> the shape will remain static.</p>

<center><i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i></center>

<ul>
  <li>line 30</li>
</ul>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="m">30</span><span class="w">    </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"National Parks"</span><span class="p">)</span><span class="w">  </span><span class="o">%&gt;%</span></code></pre></figure>

<p>Since Leaflet adds all new data to the top of the base map, I think it‚Äôs useful to group the layers together. In the next block of code, we add in some layer functionality. For now, though, I want to add the National Parks to their own group so I can hide the National Parks if I want.</p>

<center><i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i> <i class="fa-solid fa-paw"></i></center>

<ul>
  <li>line 31-34</li>
</ul>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="m">31</span><span class="w">    </span><span class="n">addLayersControl</span><span class="p">(</span><span class="w">
</span><span class="m">32</span><span class="w">        </span><span class="n">baseGroups</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Base Map"</span><span class="p">,</span><span class="w">
</span><span class="m">33</span><span class="w">        </span><span class="n">overlayGroups</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"National Parks"</span><span class="p">,</span><span class="w">
</span><span class="m">34</span><span class="w">        </span><span class="n">options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">layersControlOptions</span><span class="p">(</span><span class="n">collapsed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">))</span></code></pre></figure>

<p><code>addLayersControl</code> defines how layers are displayed on the final map. The function takes three arguments.</p>

<p>First, we have to tell Leaflet which layer should be used as the base map: <code>baseGroups = "Base Map"</code>. The name in the quotations (here: <code>"Base Map"</code>) has to match the name given to the layer you set in the <code>addPolygons()</code> call. In line 14, I put the 50 states into a group called <code>"Base Map"</code>, but you can name it anything you like.</p>

<p>There can be more than one base map, too. It‚Äôs not super helpful here since I shifted Alaska and Hawaii, but when using <a href="https://openmaptiles.org/styles/" target="_blank" rel="noopener noreferrer">map tiles</a> you can add multiple types of base maps that users can switch between.</p>

<p>Next, we have to define the layers that are shown <em>on top</em> of the base group: <code>overlayGroups = "National Parks"</code>. Just like the base map, this is defined in the corresponding <code>addPolygons</code> call. Here, I called the layer <code>National Parks</code> in line 30.</p>

<p>Finally, on the map I don‚Äôt want the layers to be collapsed, so I set <code>options = layersControlOptions(collapsed = FALSE)</code>. When <code>TRUE</code> the map will display an icon in the top right that, when clicked, will show the available layers.</p>

<figure>
    
    <a href="/assets/notes-images/nps/nps-21.jpg" target="_blank" rel="noopener noreferrer">
        <img src="/assets/notes-images/nps/nps-21.jpg" alt="Image: Layers collapsed" class="img-fluid mx-auto d-block" />
    </a>
    
    <figcaption><span>Layers collapsed</span></figcaption>
</figure>

<h3 id="6-conclusion">6. conclusion</h3>
<p>Hey, look at that! You made a base map <em>and</em> you added some National Park data to it. You‚Äôre a certified cartographer now!</p>

<p>In the next <a href="http://localhost:4000/notes/cartography-part-four" target="_blank" rel="noopener noreferrer">part IV</a> post we‚Äôll download and process the state park data before adding it to the map. <a href="http://localhost:4000/notes/cartography-part-five" target="_blank" rel="noopener noreferrer">Part V</a> of this series we‚Äôll add <em>Shiny</em> functionality and some additional markers.</p>

<iframe seamless="" src="/assets/notes-images/nps/maps/nps.html" width="100%" height="500"></iframe>
<figcaption>Map showing US National Parks</figcaption>
<p>&lt;/figure&gt;</p>
:ET