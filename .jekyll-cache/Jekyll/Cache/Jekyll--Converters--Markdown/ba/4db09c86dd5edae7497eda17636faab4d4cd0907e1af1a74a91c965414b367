I"Ö-<p>This is part three of my <a href="https://liz-muehlmann.github.io/pages/tag-forest.html/#cartography">cartography in R</a> series. The links to <a href="https://liz-muehlmann.github.io/notes/cartography-part-one">part one</a> and <a href="https://liz-muehlmann.github.io/notes/cartography-part-two">part two</a> are here.</p>

<p>In this post, weâ€™ll process the National Park data before adding it to the base map created in <a href="https://liz-muehlmann.github.io/notes/cartography-part-two">part two</a>. Iâ€™ll also add in pop up markers with images from the National Parks Iâ€™ve visited that link to the blog post where Iâ€™ve written about my adventures there.
<!--more--></p>

<p><i class="fa-regular fa-note-sticky fa-xl"></i> <i>Note:</i> I know that my posts are verbose. I am sorry that I am not more concise but one of the biggest problems I have with code documentation is that it assumes you already know what youâ€™re doing. Iâ€™m writing these for absolute beginners that want to know what each part of the code does. If you want more concise explanations, I suggest looking at the annotated <a href="https://github.com/liz-muehlmann/nps">r files</a> in this projectâ€™s GitHub.</p>

<h3>project outline</h3>
<hr />

<p>I had to break the tutorial into different parts because it became unwieldy. I list the component parts below. The annotated version of the code can be found in this projectâ€™s repository in the folder called <a href="https://github.com/liz-muehlmann/nps">r files</a>.</p>

<p><a href="https://liz-muehlmann.github.io/notes/cartography-part-one"><u>I. cartography in R part one</u></a></p>
<ul><li>Install packages</li>
<li> Process USA data</li>
<li> Shift Alaska and Hawaii</li>
<li> Save shapefile</li></ul>

<p><a href="https://liz-muehlmann.github.io/notes/cartography-part-two"><u>II. cartography in R part two</u></a></p>
<ul><li> Create USA base map</li></ul>

<p><a href="https://liz-muehlmann.github.io/notes/cartography-part-three"><u>III. cartography in R part three [this post]</u></a></p>
<ul><li>Process national and state park data</li>
<li>Add national and state park data to the base map</li></ul>

<p><a href="https://liz-muehlmann.github.io/notes/cartography-part-four"><u>IV. cartography in R part four</u></a></p>
<ul><li>Add in Shiny functionality</li>
<li>Save final map</li>
<li>Publish map</li></ul>

<h3>1. load the libraries</h3>
<hr />

<figure class="highlight"><pre><code class="language-r" data-lang="r"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="code"><pre><span class="w">    </span><span class="c1">## load libraries</span><span class="w">
    </span><span class="n">library</span><span class="p">(</span><span class="s2">"tidyverse"</span><span class="p">)</span><span class="w">    </span><span class="c1"># data manipulation &amp; map creation</span><span class="w">
    </span><span class="n">library</span><span class="p">(</span><span class="s2">"sf"</span><span class="p">)</span><span class="w">           </span><span class="c1"># loads shapefile</span><span class="w">
    </span><span class="n">library</span><span class="p">(</span><span class="s2">"leaflet"</span><span class="p">)</span><span class="w">      </span><span class="c1"># creates the map</span><span class="w">

    </span><span class="c1">## load data</span><span class="w">
    </span><span class="n">states</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_sf</span><span class="p">(</span><span class="s2">"~/Documents/Github/nps/shapefiles/shifted/usa/usa.shp"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>I am not going to explain in detail what each line is doing here, because itâ€™s already available in part one.</p>

<p>In line 7 be sure to change <code>"~/Documents/Github/nps/shapefiles/shifted/usa/usa.shp"</code> to reflect wherever you saved the shifted shapefile.</p>

<p>If your data processing and base map creation are in the same file, you can skip line 7 and use the variable name where the shape data is stored when you make the leaflet call below.</p>

<h3>2. create the base map</h3>
<hr />

<figure class="highlight"><pre><code class="language-r" data-lang="r"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="code"><pre><span class="w">    </span><span class="c1">## create usa basemap using leaflet()</span><span class="w">
    </span><span class="n">map</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">leaflet</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">                        </span><span class="c1"># initialize the map widget</span><span class="w">
    </span><span class="n">addPolygons</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">states</span><span class="p">,</span><span class="w">                  </span><span class="c1"># add state polygons</span><span class="w">
        </span><span class="n">smoothFactor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span><span class="p">,</span><span class="w">                     </span><span class="c1"># lower number means more detail</span><span class="w">
        </span><span class="n">fillColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#808080"</span><span class="p">,</span><span class="w">                  </span><span class="c1"># internal shape color</span><span class="w">
        </span><span class="n">stroke</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w">                          </span><span class="c1"># add outlines</span><span class="w">
        </span><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w">                           </span><span class="c1"># outline width</span><span class="w">
        </span><span class="n">opacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w">                          </span><span class="c1"># outline opacity</span><span class="w">
        </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#808080"</span><span class="p">,</span><span class="w">                      </span><span class="c1"># outline color    </span><span class="w">
        </span><span class="n">highlightOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">highlightOptions</span><span class="p">(</span><span class="w">    </span><span class="c1"># define hover parameters</span><span class="w">
            </span><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w">                       </span><span class="c1"># outline width [hover]</span><span class="w">
            </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#000000"</span><span class="p">,</span><span class="w">                  </span><span class="c1"># internal shape color [hover]</span><span class="w">
            </span><span class="n">fillOpacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.7</span><span class="p">,</span><span class="w">                  </span><span class="c1"># internal fill opacity [hover]</span><span class="w">
            </span><span class="n">bringToFront</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">),</span><span class="w">              </span><span class="c1"># keep base map in back</span><span class="w">
        </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"basemap"</span><span class="p">)</span><span class="w">                      </span><span class="c1"># add to group</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>A detailed description of each of these lines can be found in part II of this series. Basic comments have been added for easy reference. The National and State Park data will be added on top of the base map as additional layers.</p>

<h3>3. download national park boundaries</h3>
<hr />

<p>The first step is to download the data from <a href="https://public-nps.opendata.arcgis.com/">https://public-nps.opendata.arcgis.com/</a>. Once you click on the link youâ€™ll see a bunch of icons that lead to data different data that you can download. Click on the one for <i>boundaries</i>.</p>

<figure>
    
    <a href="/assets/notes-images/nps/nps-17.jpg" target="_blank" rel="noopener noreferrer">
        <img src="/assets/notes-images/nps/nps-17.jpg" alt="Image: NPS GIS website" class="img-fluid mx-auto d-block" />
    </a>
    
    <figcaption><span>NPS GIS website</span></figcaption>
</figure>

<p>I suggest taking some time to and looking through the site and seeing the kinds of data that are available. For now, after you click on <i>boundaries</i> the next page will have a list of all the data sets you can download. The second link should be <i>nps boundary</i> which is the one weâ€™re interested in. This will have all the data for the National Park boundaries, hiking trails, rest aries, and a ton of other data.</p>

<figure>
    
    <a href="/assets/notes-images/nps/nps-18.jpg" target="_blank" rel="noopener noreferrer">
        <img src="/assets/notes-images/nps/nps-18.jpg" alt="Image: NPS download page" class="img-fluid mx-auto d-block" />
    </a>
    
    <figcaption><span>NPS download page</span></figcaption>
</figure>

<p>Once you click on the <i>nps boundary</i> link, it will take you to a map and another download link.</p>

<figure>
    
    <a href="/assets/notes-images/nps/nps-19.jpg" target="_blank" rel="noopener noreferrer">
        <img src="/assets/notes-images/nps/nps-19.jpg" alt="Image: NPS map and download link" class="img-fluid mx-auto d-block" />
    </a>
    
    <figcaption><span>NPS map and download link</span></figcaption>
</figure>

<p>From here, youâ€™ll have a few options of what format you want the data in. We want the shapefile version.</p>

<figure>
    
    <a href="/assets/notes-images/nps/nps-20.jpg" target="_blank" rel="noopener noreferrer">
        <img src="/assets/notes-images/nps/nps-20.jpg" alt="Image: download nps shapefile" class="img-fluid mx-auto d-block" />
    </a>
    
    <figcaption><span>download nps shapefile</span></figcaption>
</figure>

<p>Once itâ€™s downloaded</p>

<h3>4. process national park data</h3>
<hr />

<h3>5. create national park labels</h3>
<hr />

<h3>6. add national parks to map</h3>
<hr />

<h3>7. conclusion</h3>
<hr />

<p><i class="fa-regular fa-note-sticky fa-xl"></i> <i>Note:</i> I will give the entire codeblock first. I also include the individual line before describing what it does. I find this to be cleaner than including a bunch of comments in the code itself. If you want to copy and paste the code to your own file, you only need to copy the code block and not each individual line.</p>

:ET